# Журнал изменений - AI Видео Генератор

## 17 июня 2025 - Переход к прямой генерации видео

### Изменения в архитектуре
- **Убрана двухэтапная генерация** (text2image → image2video)
- **Добавлена прямая генерация видео** из загруженного пользователем изображения
- Приложение теперь принимает изображение от пользователя и сразу генерирует видео

### Изменения в API (`app/api/generate/route.ts`)
- Удален этап генерации изображения из текста
- Функция `prepareWorkflow` упрощена: убран параметр `mode`, оставлен только `image2video`
- Функция `pollForResult` теперь работает только с режимом `image2video`
- Функция `findResultInHistory` убрала поддержку `text2image` результатов
- Изменен путь загрузки изображений: с `gen/txt2img/` на `uploads/`

### Изменения в UI (`app/page.tsx`)
- Обновлен текст прогресса: убрано упоминание "двухэтапной генерации"
- Секция результатов теперь показывает:
  - **Исходное изображение** (загруженное пользователем) вместо "Результат - Изображение"
  - **Результат - Видео** (сгенерированное из исходного изображения)
- Обновлены тексты загрузки и плейсхолдеры

### Технические улучшения
- Упрощена логика обработки workflow
- Уменьшено время ожидания за счет исключения первого этапа
- Улучшена читаемость кода

### Совместимость
- Все существующие ComfyUI workflow должны быть обновлены для работы с прямой генерацией видео
- Плейсхолдеры `IMG_PLACEHOLDER` теперь ссылаются на загруженные пользователем изображения
- Мок режим продолжает работать без изменений

### Преимущества новой архитектуры
1. **Быстрее**: исключен этап генерации изображения
2. **Проще**: пользователь контролирует исходное изображение
3. **Предсказуемее**: результат зависит от качества загруженного изображения
4. **Экономичнее**: требует меньше вычислительных ресурсов

### Следующие шаги
- Обновить документацию ComfyUI workflow примеров
- Добавить валидацию формата и размера загружаемых изображений
- Реализовать загрузку изображений на S3 (сейчас используется placeholder) 